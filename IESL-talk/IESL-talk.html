<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Statistics and Data Science Applications for Engineers</title>
    <meta charset="utf-8" />
    <script src="IESL-talk_files/header-attrs/header-attrs.js"></script>
    <link href="IESL-talk_files/font-awesome-animation/font-awesome-animation-emi.css" rel="stylesheet" />
    <script src="IESL-talk_files/fontawesome/js/fontawesome-all.min.js"></script>
    <link href="IESL-talk_files/font-awesome/css/fontawesome-all.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

.title[
# Statistics and Data Science Applications for Engineers
]
.date[
### </br></br>Dr.Â Priyanga Dilini Talagala </br><span>&lt;i class="fas  fa-globe faa-horizontal animated " style=" color:green;"&gt;&lt;/i&gt;</span> <span style="color:lightgreen">prital.netlify.app</span></br></br> </br> <span style="font-size:15.0pt; color:lightgreen">28/09/2024</span></br> <span style="font-size:18.0pt; color:#e36200">Webinar jointly organized by Institute of Engineers, Sri Lanka (IESL) and Institute of Applied Statistics, Sri Lanka (IASSL) </span>
]

---






class: center, middle, inverse

# Anomaly Detection


---
class: center, middle
.pull-left[ 
### High Dimensional data 

&lt;img src="fig/2_outtypea.png" width="90%" /&gt;
]
--
.pull-right[
### Temporal data

&lt;img src="fig/2_outtypeb.png" width="90%" /&gt;
]

---

class: center, middle, inverse

# Monitoring Systems in Engineering in the Information Age


---

background-image:url('fig/sydney.jpeg')
background-position: 50% 50%
background-size: 100%
class: left, top, clear


---

background-image:url('fig/2_sydney22.png')
background-position: 80% 50%
background-size: 100%
class: left, top, clear


---

background-image:url('fig/condition.png')
background-position: 80% 50%
background-size: 100%
class: left, top, clear

---

background-image:url('fig/app1.png')
background-position: 80% 50%
background-size: 100%
class: left, top, clear


---

background-image:url('fig/app2.png')
background-position: 80% 50%
background-size: 100%
class: left, top, clear


---
background-image:url('fig/4_outtype2.png')
background-position: 50% 70%
background-size:80%
class: left, top, clear

## Anomalies in temporal data
---
- Approaches to solving the problem of anomaly detection for temporal data :
--
.pull-left[
### Batch scenario 
- whole set of data is available
- Complete events &lt;br/&gt;&lt;br/&gt;&lt;br/&gt;

&lt;img src="fig/6_batch.png" width="100%" /&gt;
]
--
.pull-right[
### Data stream scenario
- Continuous, unbounded, flow at high speed, high volume
- Incomplete events
&lt;img src="fig/7_stream.gif" width="100%" /&gt;
]
---
background-image:url('fig/stray.png')
background-position: 80% 50%
background-size: 100%
class: left, top, clear


---

## Anomaly detection in high dimensional Data


### What is an anomaly ?
- We define an anomaly as an observation that deviates markedly from the majority with a large distance gap.
--


### Main assumptions
- There is a large distance between typical data and the anomalies in comparison to the distance among typical data.

---

## stray

&lt;img src="fig/9_stray_plot1.png" width="50%" style="display: block; margin: auto;" /&gt;
-  Normalize the columns of the data. (median and IQR)
-  This prevents variables with large variances having disproportional influence on Euclidean distances.
---

## Why not "nearest neighbour" distances? 
&lt;img src="fig/9_stray_plot2.png" width="50%" style="display: block; margin: auto;" /&gt;

- Calculate the nearest neighbour distance 
---
## stray -  "k- nearest neighbour" distances 
&lt;img src="fig/9_stray_plot5.png" width="50%" style="display: block; margin: auto;" /&gt;


- Select the &lt;span style="color:red"&gt; k nearest neighbour &lt;/span&gt; distance with the &lt;span style="color:red"&gt; maximum gap &lt;/span&gt;
---
#### Calculate anomalous threshold

- Use extreme value theory (EVT) to calculate a data driven outlier threshold.

&lt;img src="fig/evt.png" width="40%" style="display: block; margin: auto;" /&gt;

---
**Spacing theorem (Weissman, 1978)**

.pull-left[

Let `\(X_{1}, X_{2}, ..., X_{n}\)` be a sample from a distribution function `\(F\)` . &lt;/br&gt;
Let `\(X_{1:n} \geq X_{2:n} \geq ... \geq X_{n:n}\)` be the order statistics. &lt;/br&gt;
The available data are `\(X_{1:n}, X_{2:n},  ..., X_{k:n}\)` for some fixed `\(k\)`. &lt;/br&gt;
Let `\(D_{i,n} = X_{i:n} - X_{i+1:n},\)` `\((i = 1,2,..., k)\)` be the spacing between successive order statistics.&lt;/br&gt;
If `\(F\)` is in the maximum domain of attraction of the Gumbel distribution, then the spacings `\(D_{i,n}\)` are asymptotically independent and exponentially distributed with mean proportional to `\(i^{-1}\)`.
].pull-right[
&lt;img src="fig/10_spacingTheorem.png" width="100%" /&gt;
]

---

## stray
&lt;img src="fig/11_stray_plot6.png" width="50%" style="display: block; margin: auto;" /&gt;

`outliers &lt;- find_HDoutliers(data)` &lt;br/&gt;
`display_HDoutliers(data, outliers)`
---
## Advantages of the proposed algorithm

- Detect clusters of outlying points

--

- Applied to both uni- and multi- dimensional data

--

- Handle large datasets due to the use of approximate KNN searching algorithm

--

- Does not require a training set to build the decision model

--

- Deal with multimodal typical classes

--

- Outlier threshold has a probabilistic interpretation

---
background-image:url('fig/4_outtype2.png')
background-position: 50% 70%
background-size:80%
class: left, top, clear

## Anomalies in temporal data
---
## Feature based representation of time series
.pull-left[
- Mean   

- Variance  

- Changing variance in remainder 

- Level shift using rolling window  

- Variance change  

- Strength of linearity 

- Strength of curvature  
 ]

.pull-right[
- Strength of spikiness 

- Burstiness of time series (Fano Factor) 

- Minimum  

- Maximum  

- The ratio between 50% trimmed mean and the arithmetic mean

- Moment 

- Ratio of means of data that is below and above the global mean  

]
---
### Approach 1: Using stray

- use a moving window to deal with streaming data

- Extract time series features from window

- Apply stray algorithm to identify anomalous series

.pull-left[

&lt;img src="fig/12_strayts.png" width="80%" /&gt;

]
.pull-right[
&lt;img src="fig/13_stray.gif" width="50%" /&gt;
]


---
class:: center, clear
.pull-left[
 
&lt;img src="fig/14_P2_plot21a.png" width="75%" /&gt;
]
--
.pull-right[

&lt;img src="fig/14_P2_plot21b.png" width="75%" /&gt;
]

---


background-image:url('fig/fftdata.png')
background-position: 50% 50%
background-size: 100%
class: left, top, clear
---

.pull-left[
### Feature Based Representation of Time series


&lt;img src="fig/6_batch.png" width="110%" /&gt;


]
.pull-right[
&lt;img src="fig/22_tsfeatures.png" width="90%" /&gt;
]


---
background-image:url('fig/oddstreampaper.png')
background-position: 50% 50%
background-size: 100%
class: left, top, clear

---
## Dimension reduction for time series 

.pull-left[
`load(train_data)`
&lt;img src="fig/16_typical.png" width="100%" /&gt;
]
--
.pull-right[
`tsfeatures &lt;- oddstream::extract_tsfeatures`&lt;/br&gt;`(train_data)`

&lt;img src="fig/17_high_typical.gif" width="60%" /&gt;
]

---

.pull-left[
`tsfeatures &lt;- oddstream::extract_tsfeatures`&lt;/br&gt;`(train_data)`

&lt;img src="fig/17_high_typical.gif" width="70%" /&gt;
]
--
.pull-right[
`pc&lt;- oddstream::get_pc_space(tsfeatures)`&lt;/br&gt;
`oddstream::plotpc(pc$pcnorm)` 
&lt;img src="fig/18_typicalfeature.png" width="90%" /&gt;
]
---
## Anomalous threshold calculation 

- Estimate the probability density function of the 2D PC space `\(\longrightarrow\)` Kernel density estimation
--

- Draw a large number N of extremes `\((arg min_{x\in X}[f_{2}(x)])\)` from the estimated probability density function
--

- Define a `\(\Psi\)`-transform space, using the `\(\Psi\)`-transformation defined by (Clifton et al., 2011)

&lt;img src="fig/19_psitrans.png" width="50%" /&gt;

- `\(\Psi\)`-transform maps the density values back into space into which a Gumbel distribution can be fitted.
--

- Anomalous threshold calculation `\(\longrightarrow\)` extreme value theory


---
class: center, top, clear
`oddstream::find_odd_streams(train_data, test_stream)`
&lt;img src="fig/19_oddstream_mvtsplot.gif" width="40%" /&gt;
.pull-left[
&lt;img src="fig/20_oddstream_out_loc.gif" width="60%" /&gt;
]
.pull-right[
&lt;img src="fig/21_oddstream_pcplot.gif" width="60%" /&gt;
]
---

class:  center, middle, inverse


# Adaptive Anomaly Detection

## Managing &lt;span style="color:#ffff05"&gt;Concept Drift &lt;/span&gt;  in Data Streams

---

background-image:url('fig/23_nonstationaritytypes.png')
background-position: 50% 50%
background-size: 50%
class: left, top, clear

---

class:  center, middle

&lt;img src="fig/24_suddenplot2.png" width="85%" height="10%" /&gt;

&lt;img src="fig/25_noCD1.png" width="30%" /&gt;
---

class:  center, middle

&lt;img src="fig/26_suddenplot3.png" width="85%" height="10%" /&gt;

&lt;img src="fig/27_noCD2.png" width="30%" /&gt;

---

class:  center, middle

&lt;img src="fig/28_suddenplot4.png" width="85%" height="10%" /&gt;

&lt;img src="fig/29_noCD3.png" width="30%" /&gt;

---

class:  center, middle
**Managing Concept Drift Through Adaptive Anomaly Detection**

&lt;img src="fig/30_suddenplot2.png" width="70%" height="10%" /&gt;

&lt;img src="fig/31_conceptdrift_pval.png" width="80%" /&gt;

`$$H_{0} : f_{t_{0}} = f_{t_{t}}$$`


- squared discrepancy measure `\(T = \int[f_{t_{0}}(x) - f_{t_{t}}(x)]^{2}dx\)` (Anderson et al., 1994)

---

class:  center, middle

**Managing Concept Drift Through Adaptive Anomaly Detection**

&lt;img src="fig/32_sudden_out.png" width="80%" /&gt;


---
class: clear, middle, center
.pull-left[
### stray
 
&lt;img src="fig/33_P2_plot21a.png" width="65%" /&gt;

- Definition: distance 
- no training set 
]
.pull-right[
### oddstream

&lt;img src="fig/34_P2_plot21b.png" width="65%" /&gt;

- Definition: density
- need a training set
]

---

background-image:url('fig/2_outtypeb.png')
background-position: 50% 70%
background-size:100%
class: left, top, clear

## Anomalies in temporal data
---

## Technical issues in sensor equipments

This work is part of a collaborative research project with Queensland University of Technology, the &lt;span style="color:red"&gt; Queensland Department of Environment and Science &lt;/span&gt;, and the &lt;span style="color:red"&gt; National Ecological Observatory Network (NEON) in the USA  &lt;/span&gt;, as part of the Great Barrier Reef Catchment Loads Monitoring Program in Australia.


&lt;img src="fig/sensor.png" width="75%" style="display: block; margin: auto;" /&gt;
---
background-image:url('fig/3_Techissues.png')
background-position: 50% 70%
background-size:100%
class: left, top, clear

---
background-image:url('fig/water.png')
background-position: 50% 70%
background-size:100%
class: left, top, clear


---

background-image:url('fig/techissues.png')
background-position: 50% 70%
background-size:80%
class: left, top, clear

## Technical issues in sensor equipments

---

background-image:url('fig/18_upstream_b.png')
background-position: 50% 70%
background-size:90%
class: left, top, clear



---
class: center, middle, inverse

# &lt;span style="color:#ffff05"&gt; Anomaly Detection in Image Time Series (ITS)  &lt;/span&gt;




---
A Satellite Image Time Series (SITS) - set of satellite images taken from the same scene at different times

.pull-left[

&lt;img src="fig/37_deforestation.gif" width="100%" style="display: block; margin: auto;" /&gt;
].pull-right[
&lt;img src="fig/38_volcano.gif" width="100%" style="display: block; margin: auto;" /&gt;

]
---
background-image:url('fig/Agricultural-drone.jpg')
background-position: 50% 70%
background-size:100%
class: left, top, clear

---

### Binary Classification using Forecasting and EVT based Threshold

&lt;img src="fig/41_threshold.png" width="100%" /&gt;
---

class: center, middle, inverse

# Myth 

## We now have AI and Machine Learning so don't need statistics anymore.

---

background-image:url('fig/GDPR.png')
background-position: 50% 70%
background-size:100%
class: left, top, clear

---

- The problem with many state-of-the-art AI models is a lack of transparency and interpretability 

- Hard to explain internal logic and inner workings
--

## Statistics Remains Vital
   
- Fundamental for AI and  Explanable AI
   
- Essential for interpreting and validating AI models.
   
- When data is limited, statistical methods are often the most reliable approach.
---


class: center, middle, inverse

# Myth 

## ~~We now have AI and Machine Learning so don't need statistics anymore.~~

## Statistics powers AI and Machine Learning for smarter engineering decisions!


---
class: center, middle, inverse

# Thank You

<i class="fas  fa-envelope "></i>
priyangad@uom.lk

<i class="fab  fa-github "></i><i class="fab  fa-twitter "></i>
pridiltal

<i class="fas  fa-globe "></i>
prital.netlify.app &lt;/br&gt;
(Slides and papers available)

&lt;br/&gt;&lt;br/&gt;The slides are powered by xaringan R package  

    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"slideNumberFormat": "%current%",
"highlightStyle": "github",
"highlightLines": true,
"ratio": "16:9",
"countIncrementalSlides": true
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
